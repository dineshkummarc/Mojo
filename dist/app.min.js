(function(h,e){var f=function(){};f.controllers={};f.applications={};f.options={};f._loaded=[];f._resolvedNamespace=function(a){return f._namespace._provided[""+a];};f.resolve=function(a){if(!f._namespace._provided[a]){return a.replace(/\./gi,"/");}return false;};f._namespace=function(d){var c=(""+d).split(/\./),a=c.length,b=[],i=window||{};if(!f._namespace._provided){f._namespace._provided={};}if(f._namespace._provided[d]==d){throw new Error(d+" has already been defined.");}for(var m=0;m<a;m+=1){var n=c[m];if(!i[n]){b[m]=n;i[n]=function(){};f._namespace._provided[b.join(".")]=i[n];}i=i[n];}return i;};f.query=function(){return jQuery.apply(this,arguments);};f.queryFirst=function(){return f.query.apply(this,arguments)[0];};f.require=function(i,a){if(!$.isArray(i)){i=[i];}var n=i.length,c=f.options.baseSrc,b=0;for(var o=0;o<n;o++){var d=i[o];var c=f.options.baseSrc+f.resolve(d)+".js";f._loaded.push(i[o]);$.getScript(c,function(){b++;});}var p=setInterval(function(){if(a&&b==n){clearInterval(p);a.call(this);}},25);};f.fetch=function(b,a){$.getScript(b,function(){if(a){a.apply(this,arguments);}});};f.define=function g(){var b=arguments,d=b.length;for(var a=0;a<d;a++){if(typeof b[a]=="function"){b[a]=b[a].call(this);}}var c;if(d>2){c=b[2];}else{if($.isArray(b[0])){f.require(b[0],function(){console.log("Anonymous Module");});}else{if(typeof b[1]=="object"){c=b[1];}}}if(typeof b[0]=="string"){f._namespace(b[0]);f._loaded[""+b[0]]=c;f.controllers[b[0]]=c;}};f.create=function(a){if(typeof a=="undefined"){a={};if(!a.baseSrc){a.baseSrc="js/";}if(!a.mojoSrc){a.mojoSrc="../src";}}$.extend(this.options,a);return new Application();};window.MOJO=f;})(window,document);MOJO.define("Request",["Controller"],function(){function b(f,a,g,h){this.paramsObj=f;this.callerObj=a;this.eventObj=g;this.controllerObj=h;}b.prototype.getController=function(){return this.controllerObj;};b.prototype.getContextElement=function(){return this.getController().getContextElement();};b.prototype.getCaller=function(){return this.callerObj;};b.prototype.getEvent=function(){return this.eventObj;};window.Request=b;return b;});MOJO.define("Controller",["Request"],function(){function b(){this.contextElement=null;this.controllerClass=null;this.events;}b.prototype.onInit=function(){};b.prototype.onParamChange=function(){};b.prototype.initialize=function(h,g,f){var a=this;a.contextElement=h;a.controllerClass=g;a.params=f;$(a.events).each(function(e,m){var o=$(document),c=m[0],p=m[1],n=m[2],d=m[3];if(c=="context"){o=$(h);}$(o).delegate(p,n,function(i){var j=new Request({},this,i,a);if(typeof a.before!="undefined"&&typeof a.before[d]!="undefined"){a.before[d].call(a,j);}a.methods[d].call(a,j);if(typeof a.after!="undefined"&&typeof a.after[d]!="undefined"){a.after[d].call(a,j);}});});a.onInit();};b.prototype.getContextElement=function(){if(!this.contextElement){return null;}return this.contextElement;};b.prototype.param=function(a,d){if(arguments.length>1){this.params[a]=d;this.onParamChange();return this;}else{return this.params[a];}};window.Controller=b;return b;});MOJO.define("Application",["Controller"],function(){function b(){if(!this.options){this.options={};}var a=this,d=a.options;d.locale="en_CA";d.plugins=[];d.pluginSrc="js/lib/plugins/";d.environment="dev";d.selector=jQuery||(function(){throw new Error("Unable to find jQuery");})();a.siteMap=[];}b.prototype.onComplete=function(){};b.prototype.configure=function(a,e){if(arguments.length>1){this.options[a]=e;try{console.info("Configure: ",a," -> ",e);}catch(f){}return this;}else{return this.options[a];}};b.prototype.map=function(a,f){var h=this;var g=$(a);g.each(function(d,c){h.siteMap.push({context:c,init:f});});f.call(this,h);return this;};b.prototype.heal=function(){return this;};b.prototype.setupController=function(l,a,h){var j=$(l);var k=MOJO.controllers[a],i=new Controller(),k=$.extend(k,i);MOJO.controllers[a]=k;if(typeof k=="undefined"){throw new Error("Undefined Controller @ ",a);}k.initialize(l,a,h);if(typeof k.after!="undefined"&&k.after.Start!="undefined"){k.after.Start.call(k,null);}};b.prototype.disconnectControllers=function(d){var a=this;$(a.siteMap).each(function(f,c){$(c.context).unbind().undelegate();});d.apply(a);};b.prototype.connectControllers=function(){var a=this,d=[];$(a.siteMap).each(function(g,h){var c=h.init.call(this);$(c).each(function(f,e){if(!MOJO._loaded.length||$.inArray(e.controller,MOJO._loaded)==-1){d.push(e.controller);}else{MOJO._loaded.push(e.controller);}});});MOJO.require($.unique(d),function(){$(a.siteMap).each(function(i,j){if(a.options.environment=="dev"){try{console.log("Mapping: ",j.context);}catch(c){}}var h=j.init.call(this);$(h).each(function(f,e){a.setupController(j.context,e.controller,e.params);});});});};b.prototype.on=function(a,d){return function(){};};b.prototype.getPlugins=function(e){var a=this,f=a.options.pluginSrc;$(a.options.plugins).each(function(d,c){MOJO.fetch(f+c+".js");});e.call(a);};b.prototype.start=function(){var a=this;$(document).ready(function(){a.disconnectControllers(function(){if(a.options.plugins.length){a.getPlugins(function(){a.connectControllers();});}else{a.connectControllers();}a.onComplete();});});};window.Application=b;return b;});MOJO.define("Service",[],function(){function b(h,g,a){if(typeof a=="undefined"){a={};}var f={method:a.method||function(){var c="get";if(h.match(/^get/i)){c="get";}else{if(h.match(/^add|del|update/i)){c="post";}}return c;}(),template:false};this.name=h;this.uri=g;this.options=$.extend({},f,a);}b.prototype.invoke=function(l,j,n){var a=this;var o=this.getOptions()||{},k=o.method,m=a.getURI(),p=o.responseType||"JSON";if(o.template){m=$.tmpl(m,l);l=null;}$.ajaxSetup({dataTypeString:p,type:k,cache:o.cache||"false",contentType:"application/json; charset=utf-8"});$.ajax({url:m,data:l}).success(function(c){if(p=="JSON"){c=$.parseJSON(c);}if(typeof j=="function"){j.call(n,null,c);}else{n[j](null,c);}}).error(function(){j.call(n,"Unable to execute XHR",arguments);});};b.prototype.getName=function(){return this.name;};b.prototype.getURI=function(){return this.uri;};b.prototype.getOptions=function(){return this.options;};b.prototype.option=function(){if(arguments.length>1){this.options[arguments[0]]=arguments[1];}else{return this.options[arguments[0]];}};window.Service=b;return b;});MOJO.define("ServiceLocator",[],function(){var b={services:{},addService:function(a){this.services[a.name]=a;return this;},getService:function(a){return this.services[a];},removeService:function(a){delete this.services[a];},removeServices:function(){this.services={};}};window.ServiceLocator=b;return b;});MOJO.define("ExampleApp.LoginController",{events:[["context",".btn-login","click","Login"],["context",".btn-logout","click","Logout"],["context",".btn-ajax-test","","LoginServiceCall"]],methods:{Login:function(b){var a=b.getContextElement();alert("Logged in from "+this.controllerClass);},Logout:function(a){alert("Logged out from "+this.controllerClass);}},before:{Login:function(){console.log("[intercept] Before Login");}},after:{Start:function(){},Login:function(){console.log("[intercept] After Login");}}});MOJO.define("ExampleApp.RegistrationController",{events:[["context",".btn-submit-registration","click","Register"],["dom",".btn-test-outside","click","Register"]],methods:{Register:function(b){var a=b.getContextElement();alert("REGISTER from "+this.controllerClass);}}});MOJO.define("ExampleApp.GalleryController",{events:[],methods:{},after:{Start:function(){$("#mycarousel",this.getContextElement()).jcarousel();}}});MOJO.define("ExampleApp.member.ProfileController",{events:[["context",".btn-save-profile","click","Save"]],methods:{Save:function(b){var a={};$("input[type=text], textarea").each(function(d,c){c=$(c);a[c.attr("name")]=c.val();});ServiceLocator.getService("UpdateProfile").invoke(a,function(c,d){console.log("Success!");$(".success",this.getContextElement()).show("fast");},this);}},after:{Start:function(){var a=this;$.each(this.params,function(b,c){$("input[name='"+b+"']",a.getContextElement()).val(c);});}}});